Question 1: gloud version

Question 2: terraform apply

Question 3: Count records

select count(1) from yellow_taxi_trips
where cast(tpep_pickup_datetime as DATE) = '2021-01-15'

Question 4: Largest tip for each day

select max(tip_amount), cast(tpep_pickup_datetime as DATE)
from yellow_taxi_trips
group by cast(tpep_pickup_datetime as DATE)
order by max(tip_amount) desc

Question 5: Most popular destination 

select*
from(
select t1."DOLocationID", count(1) as cnt
from yellow_taxi_trips t1
join zone t2
on t1."PULocationID" = t2."LocationID"
where cast(t1."tpep_pickup_datetime" as DATE) = '2021-01-14' and t2."Zone" = 'Central Park'
group by t1."DOLocationID"
order by cnt desc) t3
join zone t4
on t3."DOLocationID"= t4."LocationID"
order by t3."cnt" desc

Question 6: Most expensive route 

select*
from(select "PULocationID", "DOLocationID", avg(total_amount) as avg
from yellow_taxi_trips
group by "PULocationID", "DOLocationID"
order by avg desc) t1
join zone t2
on t1."PULocationID"=t2."LocationID"
join zone t3
on t1."DOLocationID"=t3."LocationID"
